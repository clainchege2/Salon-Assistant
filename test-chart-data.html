<!DOCTYPE html>
<html>
<head>
    <title>Test Analytics Data</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .range-btn { margin: 5px; padding: 10px 15px; cursor: pointer; }
        .range-btn.active { background: #ff69b4; color: white; }
        #output { margin-top: 20px; white-space: pre-wrap; font-family: monospace; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>Analytics Data Test</h1>
    
    <div>
        <button class="range-btn" onclick="testRange('1D')">1D</button>
        <button class="range-btn" onclick="testRange('7D')">7D</button>
        <button class="range-btn" onclick="testRange('30D')">30D</button>
        <button class="range-btn" onclick="testRange('90D')">90D</button>
        <button class="range-btn" onclick="testRange('180D')">180D</button>
        <button class="range-btn" onclick="testRange('1Y')">1Y</button>
        <button class="range-btn" onclick="testRange('2Y')">2Y</button>
        <button class="range-btn" onclick="testRange('3Y')">3Y</button>
        <button class="range-btn" onclick="testRange('5Y')">5Y</button>
        <button class="range-btn" onclick="testRange('10Y')">10Y</button>
        <button class="range-btn" onclick="testRange('15Y')">15Y</button>
        <button class="range-btn" onclick="testRange('20Y')">20Y</button>
        <button class="range-btn" onclick="testRange('ALL')">ALL</button>
    </div>
    
    <div id="output">Click a range button to test...</div>
    
    <script>
        async function testRange(range) {
            const output = document.getElementById('output');
            output.innerHTML = `Testing ${range}...\n`;
            
            try {
                // Get token from localStorage (assuming you're logged in)
                const token = localStorage.getItem('adminToken');
                if (!token) {
                    output.innerHTML += '<span class="error">Error: No admin token found. Please login first.</span>';
                    return;
                }
                
                const response = await fetch(`http://localhost:5000/api/analytics/overview?range=${range}`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (!response.ok) {
                    output.innerHTML += `<span class="error">Error: ${response.status} ${response.statusText}</span>`;
                    return;
                }
                
                const data = await response.json();
                
                output.innerHTML += `<span class="success">âœ“ Success!</span>\n\n`;
                output.innerHTML += `Total Revenue: $${data.totalRevenue?.toFixed(2) || 0}\n`;
                output.innerHTML += `Total Appointments: ${data.totalAppointments || 0}\n`;
                output.innerHTML += `Revenue Data Points: ${data.revenueData?.length || 0}\n\n`;
                
                if (data.revenueData && data.revenueData.length > 0) {
                    output.innerHTML += `First 5 data points:\n`;
                    data.revenueData.slice(0, 5).forEach((point, i) => {
                        output.innerHTML += `  ${i + 1}. ${point.date}: $${point.revenue}\n`;
                    });
                    
                    if (data.revenueData.length > 5) {
                        output.innerHTML += `  ...\n`;
                        output.innerHTML += `Last data point:\n`;
                        const last = data.revenueData[data.revenueData.length - 1];
                        output.innerHTML += `  ${data.revenueData.length}. ${last.date}: $${last.revenue}\n`;
                    }
                } else {
                    output.innerHTML += '<span class="error">No revenue data returned!</span>\n';
                }
                
            } catch (error) {
                output.innerHTML += `<span class="error">Error: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>
